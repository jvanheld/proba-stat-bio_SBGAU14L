---
title: 'Tuto/exo: tirage de nombres d''une distribution de probabilité'
author: "Votre nom"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: yes
    code_folding: hide
    collapsed: true
    fig_caption: true
    highlight: zenburn
    theme: cerulean
    toc: true
    toc_depth: 3
    toc_float: true
  pdf_document:
    fig_caption: true
    highlight: zenburn
    toc: true
    toc_depth: 3
  html_notebook:
    self_contained: yes
    code_folding: show
    collapsed: false
    fig_caption: true
    highlight: zenburn
    theme: cerulean
    toc: true
    toc_depth: 3
    toc_float: true
  word_document:
    toc: true
    toc_depth: '3'
editor_options:
  chunk_output_type: console
---



```{r settings, include=FALSE, echo=FALSE, eval=TRUE}
library(knitr)

options(width = 300)
# options(encoding = 'UTF-8')
knitr::opts_chunk$set(
  fig.width = 7, fig.height = 5, 
  fig.path = 'figures/sampling_',
  fig.align = "center", 
  size = "tiny", 
  echo = TRUE, 
  eval = TRUE, 
  warning = FALSE, 
  message = FALSE, 
  results = TRUE, 
  comment = "")

options(scipen = 12) ## Max number of digits for non-scientific notation
# knitr::asis_output("\\footnotesize")

```



## Tutoriel

Dans ce tutoriel, nous illustrons quelques concepts de base de l'échantillonnage statistique, et proposons quelques exercices pour vous familiariser avec ces concepts, et avec les fonctions R pertinentes. 


```{r sampling_nomal_simple}
# Generate 100,000 numbers from a normal distribution with mean=0 and standard deviation=1
x <- rnorm(n = 100000, mean = 0, sd = 1)

# Plot a histogram of the generated numbers
hist(x, 
     main="Distribution of 100,000 random numbers from a normal distribution",
     xlab="Value")
```

### Séparation entre paramètres et exécution

Nous réécrivons ce script minimaliste en séparant les paramètres. Ceci

- améliore la lisibilité du code, 
- permet d'enrichir la documentation (commenter chaque paramètre)
- permet tester l'impact des paramètres sur le résultat

Nous utilisons la fonction `paste0()` pour écrire le titre du graphique en y incluant la valeur numérique de ces paramètres. 

Astuce : par défaut, R affiche les grands nombres en notation scientifique (ex `1e+5`). Pour éviter cela, nous remplaçons `n` par `format(n, scientific=FALSE)` dans la commande `paste0()`. 

Par convention, nous nommerons 

- `mu` la variable R qui désigne la moyenne de la distribution théorique (par référence au symbole grec $\mu$ conventionnellement utilisé)
- `sigma` la variable R qui désigne l'écart-type de la distribution théorique (par référence au symbole grec $\sigma$)




```{r sampling_normal_param}
# Parameters
n <- 100000 # Sample size
mu <- 50     # Mean of the normal distribution
sigma <- 5      # Standard deviation of the normal distribution

# Sample n numbers in a normal population of mean mu and standard deviation sigma
x <- rnorm(n = n, mean = mu, sd = sigma)

# Plot a histogram of the generated numbers
hist(x,
     main=paste0("Sampling from a normal distribution",
                 "\n", # newline character
                 "n=", format(n, scientific = FALSE),
                 ", mu=", mu,
                 ", sigma=", sigma),
     xlab="Value")

```


****************************************************************

## Exercice 1 : tirage de nombres dans une distribution aléatoire


### Distribution normale (gaussienne)

Améliorez la présentation de l'histogramme, de la façon suivante: 

- utilisez l'option `breaks` pour réduire la largeur des intervalles de classe
- choisissez une couleur qui vous plaît pour le corps et les contours de l'histogramme
- adaptez les options pour afficher horizontalement les étiquettes des axes X et Y

```{r sampling_normal}
# Parameters
n <- 100000 # Sample size
mu <- 50     # Mean of the normal distribution
sigma <- 5      # Standard deviation of the normal distribution

# Sample n numbers in a normal population of mean mu and standard deviation sigma
x <- rnorm(n = n, mean = mu, sd = sigma)

# Plot a histogram of the generated numbers


### A VOUS DE JOUER


```


****************************************************************

## Exercice 2 : tirages aléatoires dans quelques distributions théoriques


Dans les sous-sections suivantes, ajoutez des blocs de code pour effectuer un tirage dans
-les distributions suivantes

- uniforme (fonction `runif()`) dans un intervalle de $+10$ à $+20$
- $\chi^2$ chi carrée (`rchisq()`) avec 5 degrés de liberté
- Poisson (`rpois()`)) avec une espérance $\lambda=5$ 

Dans chaque cas, dessinez un histogramme pour représenter la distribution des valeurs obtenues, en indiquant le nom de la distribution et les paramètres dans le titre du graphique.

Jouez ensuite sur les paramètres pour évaluer leur impact sur la forme de la distribution. 

### Distribution uniforme


```{r sampling_uniform}

# Plot a histogram of the generated numbers
n <- 100000
my_min <- 10
my_max <- 20


## Draw random 0numbers
x <- runif(n = n, min = my_min, max = my_max)

## Plot the histogram

### A VOUS DE JOUER ###

```


### Distribution chi carrée ($\chi^2$)

Sur l'histogramme, nous marquons d'une ligne verticale la valeur des degrés de liberté. 


```{r sampling_chi2}

# Plot a histogram of the generated numbers
n <- 100000
my_df <- 5

## Draw random numbers in a chi2 distribution

### A VOUS DE JOUER ###

## Draw rthe histogram

### A VOUS DE JOUER ###


```

### Distribution de Poisson

**Astuces : ** pour la distribution Poisson, utilisez des intervalles de classe séparés par des pas de 1, allant de -0.5 jusqu'à $x_{max}+0.5$, où $x_{max}$ est le maximum des valeurs de $x$ obtenues dans votre tirage aléatoire. Pour cela, utilisez les fonctions `seq()`, `max()`. 


```{r sampling_poisson}

# Plot a histogram of the generated numbers
n <- 100000
my_lambda <- 5

## Generate te data by drawing random numbers

### A VOUS DE JOUER ###


## Draw the histogram

### A VOUS DE JOUER ###

```


****************************************************************

## Exercice 3 : distribution d'échantillonnage de la moyenne

Dans cet exercice, nous allons étudier la distribution d'échantillonnage de la moyenne, autrement dit la distribution des moyennes d'un grand nombre d'échantillons tirés aléatoirement dans une distribution théorique de notre choix (en commençant par la distribution uniforme). 

Pour cela, nous allons créer une matrice dont chaque ligne représente un tirage aléatoire  nombres, dont nous calculerons ensuite la moyenne. 

Par convention, nous nommerons nos variables

- `r` pour le nombre de répétitions de l'essai, correspondant au nombre de lignes de la matrice
- `n` pour la taille de l'échantillon, correspondant au nombre de colonnes de la matrice

**Exercice**

- Créez une matrice (avec la fonction R `matrix()`) de `r=10000` lignes et `n=5` colonnes, que vous remplirez avec des nombres aléatoires tirés dans une distribution uniforme (`runif()`) entre $10$ et $20$. 

- Calculez la moyenne marginale sur les lignes de cette matrice au  moyen de la fonction `rowMeans()`, et stockez le résultat dans un vecteur nommé `sample_means`
- Dessinez un histogramme avec les valeurs de ces moyennes marginales
- Marquez d'une barre verticale la moyenne théorique $\mu$
- Dans une autre couleur, marquez d'une barre verticale la moyenne des moyennes d'échantillon (nom de variable: `means_m`)

Interprétez les résultats : 

- Quelle est la forme générale de la distribution d'échantillonnage de la moyenne ?
- Ressemble-t-elle à la distribution théorique dont vous avez tiré les nombres ? 
- Ressemble-t-elle à une autre distribution théorique que vous connaissez ?
- La moyenne des moyennes d'échantillon correspond-elle à la moyenne théorique ?


```{r sampling_means_unif, fig.width=7, fig.height=5, out.width="80%", fig.cap="Distribution d'échantillonnage de la moyenne d'un tirage de 5 nombres dans une distribution uniforme. "}

# Plot a histogram of the generated numbers
r <- 100000     # repetitions
n <- 5          # sample size for each repetition
my_min <- 10    # min of the uniform distribution
my_max <- 20    # max of the uniform distribution

## Draw random numbers 

### A VOUS DE JOUER ###

## Inject the numbers in a matrix with r rows and n columns

### A VOUS DE JOUER ###

## Compute sample means

### A VOUS DE JOUER ###

## Compute the mean and standard deviation of the sample means

### A VOUS DE JOUER ###

## Draw a histogram

### A VOUS DE JOUER ###


```

****************************************************************

****************************************************************
